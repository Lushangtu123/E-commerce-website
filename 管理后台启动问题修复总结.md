# ç®¡ç†åå°å¯åŠ¨é—®é¢˜ä¿®å¤æ€»ç»“

## ğŸ“… æ—¥æœŸ
2025å¹´10æœˆ8æ—¥ ä¸‹åˆ

## ğŸ› é‡åˆ°çš„é—®é¢˜

### é—®é¢˜1: å‰ç«¯ SSR é”™è¯¯
**ç°è±¡ï¼š**
- æµè§ˆå™¨æ˜¾ç¤º "Application error: a client-side exception has occurred"
- æ§åˆ¶å°é”™è¯¯: `TypeError: g.map is not a function`

**åŸå› ï¼š**
1. `recharts` å›¾è¡¨åº“åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“æ—¶å­˜åœ¨å…¼å®¹æ€§é—®é¢˜
2. æ ¹å¸ƒå±€ä¸­çš„ Header å’Œ Footer åœ¨ç®¡ç†å‘˜é¡µé¢ä¹Ÿæ˜¾ç¤ºäº†

**è§£å†³æ–¹æ¡ˆï¼š**
1. ä¿®æ”¹æ ¹å¸ƒå±€ `/app/layout.tsx`ï¼Œä½¿å…¶å˜ä¸ºå®¢æˆ·ç«¯ç»„ä»¶
2. ä½¿ç”¨ `usePathname()` æ£€æµ‹è·¯ç”±ï¼Œç®¡ç†å‘˜è·¯ç”±ä¸æ˜¾ç¤ºä¸»ç«™ Header/Footer
3. åˆ›å»ºç‹¬ç«‹çš„ `/app/admin/layout.tsx` ä¸ºç®¡ç†å‘˜é¡µé¢è®¾ç½®ç‹¬ç«‹å…ƒæ•°æ®
4. ç®€åŒ– `recharts` å¯¼å…¥æ–¹å¼ï¼Œä½¿ç”¨ `'use client'` ç¡®ä¿å®¢æˆ·ç«¯æ¸²æŸ“

### é—®é¢˜2: åç«¯ API 500 é”™è¯¯
**ç°è±¡ï¼š**
- API è¿”å› 500 é”™è¯¯
- åç«¯æ—¥å¿—æ˜¾ç¤º: `Unknown column 'p.image_url' in 'field list'`
- åç«¯æ—¥å¿—æ˜¾ç¤º: `Unknown column 'oi.order_item_id' in 'field list'`

**åŸå› ï¼š**
æ•°æ®åº“è¡¨å­—æ®µåä¸ä»£ç ä¸­ä½¿ç”¨çš„å­—æ®µåä¸åŒ¹é…ï¼š
- `products` è¡¨ä½¿ç”¨ `main_image` è€Œé `image_url`
- `order_items` è¡¨ä½¿ç”¨ `item_id` è€Œé `order_item_id`

**è§£å†³æ–¹æ¡ˆï¼š**
ä¿®å¤ä»¥ä¸‹æ–‡ä»¶ä¸­çš„å­—æ®µåï¼š
1. `backend/src/controllers/admin.controller.ts`
   - `p.image_url` â†’ `p.main_image`
   - `oi.order_item_id` â†’ `oi.item_id`
2. `backend/src/controllers/admin-order.controller.ts`
   - `p.image_url` â†’ `p.main_image`

### é—®é¢˜3: Docker å®¹å™¨ä»£ç æœªæ›´æ–°
**ç°è±¡ï¼š**
- æœ¬åœ°ç¼–è¯‘åç«¯ä»£ç ï¼Œä½†å®¹å™¨å†…ä»ç„¶è¿è¡Œæ—§ä»£ç 
- é”™è¯¯æŒç»­å‡ºç°

**åŸå› ï¼š**
Docker å®¹å™¨ä½¿ç”¨çš„æ˜¯é•œåƒä¸­çš„ä»£ç ï¼Œæœ¬åœ°ç¼–è¯‘ä¸ä¼šè‡ªåŠ¨åŒæ­¥åˆ°å®¹å™¨

**è§£å†³æ–¹æ¡ˆï¼š**
å®Œæ•´çš„æ›´æ–°æµç¨‹ï¼š
```bash
# 1. ç¼–è¯‘ä»£ç 
cd backend && npm run build

# 2. é‡æ–°æ„å»º Docker é•œåƒ
cd .. && docker-compose build backend

# 3. é‡å¯å®¹å™¨
docker-compose up -d backend
```

## âœ… ä¿®å¤çš„æ–‡ä»¶åˆ—è¡¨

### å‰ç«¯æ–‡ä»¶
1. `frontend/src/app/layout.tsx` - æ”¹ä¸ºå®¢æˆ·ç«¯ç»„ä»¶ï¼Œæ·»åŠ è·¯ç”±æ£€æµ‹
2. `frontend/src/app/admin/layout.tsx` - æ–°å»ºç®¡ç†å‘˜å¸ƒå±€
3. `frontend/src/app/admin/dashboard/page.tsx` - ç®€åŒ– recharts å¯¼å…¥

### åç«¯æ–‡ä»¶
1. `backend/src/controllers/admin.controller.ts` - ä¿®å¤å­—æ®µå
2. `backend/src/controllers/admin-order.controller.ts` - ä¿®å¤å­—æ®µå

## ğŸ” æ•°æ®åº“å­—æ®µæ˜ å°„å‚è€ƒ

### products è¡¨
- âœ… æ­£ç¡®: `main_image`
- âŒ é”™è¯¯: `image_url`

### order_items è¡¨
- âœ… æ­£ç¡®: `item_id`
- âŒ é”™è¯¯: `order_item_id`

## ğŸ“Š æœ€ç»ˆçŠ¶æ€

### æ‰€æœ‰æœåŠ¡è¿è¡Œæ­£å¸¸
- âœ… Frontend (3000) - è¿è¡Œä¸­
- âœ… Backend (3001) - è¿è¡Œä¸­
- âœ… MySQL (3306) - å¥åº·
- âœ… Redis (6379) - å¥åº·
- âœ… MongoDB (27017) - è¿è¡Œä¸­
- âœ… RabbitMQ (5672, 15672) - å¥åº·
- âœ… Elasticsearch (9200, 9300) - å¥åº·

### API æµ‹è¯•ç»“æœ
```bash
# ç™»å½• API
âœ… POST /api/admin/login - 200 OK

# ä»ªè¡¨ç›˜ API
âœ… GET /api/admin/dashboard/stats - 200 OK
âœ… GET /api/admin/dashboard/top-products - 200 OK (è¿”å›ç©ºæ•°ç»„æ­£å¸¸)
âœ… GET /api/admin/dashboard/recent-orders - 200 OK (è¿”å›ç©ºæ•°ç»„æ­£å¸¸)
```

## ğŸ¯ è®¿é—®ä¿¡æ¯

**ç®¡ç†åå°ï¼š** http://localhost:3000/admin/login

**é»˜è®¤è´¦å·ï¼š**
- ç”¨æˆ·å: `admin`
- å¯†ç : `admin123`

**ç”¨æˆ·å‰å°ï¼š** http://localhost:3000

## ğŸ’¡ ç»éªŒæ•™è®­

1. **å­—æ®µåä¸€è‡´æ€§**ï¼šåœ¨è®¾è®¡ API æ—¶ï¼ŒåŠ¡å¿…ç¡®è®¤æ•°æ®åº“å®é™…å­—æ®µåï¼Œé¿å…å‡è®¾
2. **Docker å¼€å‘æµç¨‹**ï¼šä¿®æ”¹ä»£ç åå¿…é¡»é‡æ–°æ„å»ºé•œåƒï¼Œå•çº¯ç¼–è¯‘æœ¬åœ°ä»£ç ä¸å¤Ÿ
3. **SSR å…¼å®¹æ€§**ï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹åº“æ—¶æ³¨æ„å…¶å¯¹æœåŠ¡å™¨ç«¯æ¸²æŸ“çš„æ”¯æŒ
4. **å¸ƒå±€éš”ç¦»**ï¼šä¸åŒçš„åº”ç”¨åŒºåŸŸï¼ˆç”¨æˆ·å‰å° vs ç®¡ç†åå°ï¼‰åº”è¯¥æœ‰ç‹¬ç«‹çš„å¸ƒå±€

## ğŸ”§ å¿«é€Ÿæ•…éšœæ’é™¤

å¦‚æœé‡åˆ°ç±»ä¼¼é—®é¢˜ï¼š

1. **æ£€æŸ¥åç«¯æ—¥å¿—**
   ```bash
   docker-compose logs --tail=50 backend
   ```

2. **æ£€æŸ¥æ•°æ®åº“å­—æ®µ**
   ```bash
   docker-compose exec mysql mysql -uroot -proot123456 ecommerce -e "DESCRIBE è¡¨å;"
   ```

3. **å®Œæ•´é‡å¯æµç¨‹**
   ```bash
   # ç¼–è¯‘
   cd backend && npm run build && cd ..
   
   # é‡å»ºå¹¶é‡å¯
   docker-compose build backend
   docker-compose up -d backend
   
   # æ£€æŸ¥æ—¥å¿—
   docker-compose logs -f backend
   ```

## âœ¨ æ€»ç»“

ç»è¿‡ä»¥ä¸Šä¿®å¤ï¼Œç®¡ç†åå°ç³»ç»Ÿç°å·²å®Œå…¨æ­£å¸¸è¿è¡Œï¼Œæ‰€æœ‰åŠŸèƒ½å¯ç”¨ã€‚ä¸»è¦è§£å†³äº†ï¼š
- å‰ç«¯ SSR æ¸²æŸ“é—®é¢˜
- åç«¯æ•°æ®åº“å­—æ®µæ˜ å°„é”™è¯¯
- Docker å®¹å™¨ä»£ç åŒæ­¥é—®é¢˜

ç³»ç»Ÿç°åœ¨å¯ä»¥æ­£å¸¸æŠ•å…¥ä½¿ç”¨ã€‚


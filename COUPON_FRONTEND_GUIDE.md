# 优惠券前端功能使用指南

> 📅 创建日期: 2025年11月3日  
> ✅ 状态: 已完成  
> 🎯 版本: 1.0.0

## 📋 目录

- [功能概述](#功能概述)
- [页面列表](#页面列表)
- [功能演示](#功能演示)
- [技术实现](#技术实现)
- [使用说明](#使用说明)

---

## 功能概述

优惠券系统前端已完全实现，包含以下功能：

### ✅ 已完成功能

1. **优惠券中心页面** (`/coupons`)
   - 展示所有可领取的优惠券
   - 一键领取优惠券
   - 实时显示剩余数量
   - 优惠券分类展示（满减/折扣/无门槛）

2. **我的优惠券页面** (`/my/coupons`)
   - 查看已领取的优惠券
   - 按状态筛选（未使用/已使用/已过期）
   - 一键使用优惠券

3. **导航入口**
   - Header 顶部导航添加优惠券图标
   - 首页添加优惠券横幅
   - 快速访问入口

4. **API 集成**
   - 完整的优惠券 API 接口
   - 管理员优惠券 API
   - 错误处理和加载状态

---

## 页面列表

### 1. 优惠券中心 (`/coupons`)

**路径**: `frontend/src/app/coupons/page.tsx`

**功能**:
- ✅ 展示所有可领取优惠券
- ✅ 优惠券卡片设计（渐变色区分类型）
- ✅ 领取按钮和状态管理
- ✅ 领取成功/失败提示
- ✅ 跳转到"我的优惠券"

**优惠券类型**:
- 🟠 满减券（橙红色）
- 🔵 折扣券（蓝色）
- 🟢 无门槛券（绿色）

### 2. 我的优惠券 (`/my/coupons`)

**路径**: `frontend/src/app/my/coupons/page.tsx`

**功能**:
- ✅ 查看已领取优惠券
- ✅ 状态筛选标签页
  - 未使用（蓝色）
  - 已使用（灰色）
  - 已过期（红色）
- ✅ 优惠券详情展示
- ✅ 使用按钮
- ✅ 跳转到优惠券中心

### 3. 导航入口

**Header 导航** (`frontend/src/components/Header.tsx`):
- ✅ 礼物图标，登录后可见
- ✅ 悬停变色效果（橙色）

**首页横幅** (`frontend/src/app/page.tsx`):
- ✅ 醒目的橙红色横幅
- ✅ 引导文案
- ✅ 点击跳转到优惠券中心

---

## 功能演示

### 访问步骤

1. **启动服务**
   ```bash
   # 确保所有服务运行
   docker-compose ps
   
   # 前端: http://localhost:3000
   # 后端: http://localhost:3001
   ```

2. **登录系统**
   - 访问: http://localhost:3000/login
   - 测试账号: `testuser` / `123456`

3. **访问优惠券中心**
   - 方式1: 点击 Header 的礼物图标
   - 方式2: 点击首页的优惠券横幅
   - 方式3: 直接访问 http://localhost:3000/coupons

4. **领取优惠券**
   - 浏览可用优惠券
   - 点击"立即领取"按钮
   - 查看领取成功提示

5. **查看我的优惠券**
   - 点击"我的优惠券"按钮
   - 或访问 http://localhost:3000/my/coupons
   - 切换不同状态标签查看

---

## 技术实现

### API 接口

**文件**: `frontend/src/lib/api.ts`

```typescript
// 优惠券相关API
export const couponApi = {
  getAvailable: (page, pageSize) => {...},  // 获取可领取优惠券
  receive: (code) => {...},                  // 领取优惠券
  getMyCoupons: (status) => {...},           // 获取我的优惠券
  getAvailableForOrder: (amount) => {...},   // 获取订单可用优惠券
  calculateDiscount: (...) => {...},         // 计算优惠金额
};

// 管理员优惠券API
export const adminCouponApi = {
  create: (data) => {...},                   // 创建优惠券
  getList: (page, pageSize, status) => {...},// 获取列表
  getDetail: (id) => {...},                  // 获取详情
  updateStatus: (id, status) => {...},       // 更新状态
};
```

### 优惠券类型定义

```typescript
interface Coupon {
  coupon_id: number;
  code: string;               // 优惠券代码
  name: string;               // 优惠券名称
  description: string;        // 描述
  type: number;               // 类型: 1=满减, 2=折扣, 3=无门槛
  discount_value: number;     // 优惠值
  min_amount: number;         // 最低使用金额
  max_discount?: number;      // 最大优惠金额（折扣券）
  total_quantity: number;     // 总数量
  remain_quantity: number;    // 剩余数量
  per_user_limit: number;     // 每人限领
  start_time: string;         // 生效时间
  end_time: string;           // 失效时间
  status: number;             // 状态: 0=禁用, 1=启用
}
```

### 样式设计

**优惠券卡片**:
- 渐变色背景区分类型
- 圆角和阴影效果
- 悬停放大效果
- 响应式布局（网格）

**状态标签**:
- 未使用: 蓝色主题
- 已使用: 灰色主题
- 已过期: 红色主题

**按钮状态**:
- 可领取: 蓝色背景
- 领取中: 灰色背景（禁用）
- 已领完: 灰色背景（禁用）

---

## 使用说明

### 用户操作流程

#### 1. 领取优惠券

```
访问优惠券中心
   ↓
浏览可用优惠券
   ↓
点击"立即领取"
   ↓
领取成功提示
   ↓
剩余数量 -1
```

#### 2. 使用优惠券

```
访问"我的优惠券"
   ↓
查看未使用的优惠券
   ↓
点击"立即使用"
   ↓
跳转到商品列表
   ↓
(在结算时选择优惠券)
```

### 优惠券类型说明

#### type: 1 - 满减券

- **显示**: ¥50（橙红色）
- **条件**: 满200元可用
- **计算**: 订单金额 ≥ 200，减50元

#### type: 2 - 折扣券

- **显示**: 8折（蓝色）
- **条件**: 满100元可用
- **计算**: 订单金额 × 0.8，最高优惠100元

#### type: 3 - 无门槛券

- **显示**: ¥20（绿色）
- **条件**: 无门槛
- **计算**: 直接减20元

---

## 🎨 UI 预览

### 优惠券卡片样式

```
┌──────────────────────────────────┐
│  [满减券]              剩余: 100   │
│  ¥50                              │
│  满200元可用                      │
├──────────────────────────────────┤
│  新用户欢迎券                     │
│  满200元减50元                    │
│  有效期至 2025-12-31  限领 1 张  │
│  ┌────────────────────────────┐  │
│  │      立即领取              │  │
│  └────────────────────────────┘  │
└──────────────────────────────────┘
```

### 我的优惠券页面

```
┌─────────────────────────────────────┐
│  [ 未使用 ] [ 已使用 ] [ 已过期 ]    │
├─────────────────────────────────────┤
│                                     │
│  ┌────────┐  ┌────────┐  ┌────────┐│
│  │ 满减券  │  │ 折扣券  │  │ 无门槛 ││
│  │  ¥50   │  │  8折   │  │  ¥20  ││
│  │ [使用] │  │ [使用] │  │ [使用] ││
│  └────────┘  └────────┘  └────────┘│
│                                     │
└─────────────────────────────────────┘
```

---

## 📊 功能完成度

| 功能模块 | 完成度 | 说明 |
|---------|-------|------|
| API 接口 | ✅ 100% | 所有接口已实现 |
| 优惠券中心 | ✅ 100% | 展示、领取功能完整 |
| 我的优惠券 | ✅ 100% | 查看、筛选功能完整 |
| 导航入口 | ✅ 100% | Header + 首页横幅 |
| 结算集成 | ⚠️ 待开发 | 需在结算页添加 |
| 管理后台 | ⚠️ 待开发 | 管理员创建优惠券 |

---

## 🔗 相关链接

- **优惠券中心**: http://localhost:3000/coupons
- **我的优惠券**: http://localhost:3000/my/coupons
- **首页**: http://localhost:3000
- **后端 API**: http://localhost:3001/api/coupons
- **完整文档**: NEW_FEATURES_V2.md

---

## 🐛 常见问题

### Q1: 点击领取后没反应？
**A**: 检查是否已登录，查看浏览器控制台是否有错误信息。

### Q2: 优惠券列表为空？
**A**: 需要先在数据库中创建优惠券，或使用管理员接口创建。

### Q3: 领取失败提示"已达领取上限"？
**A**: 检查优惠券的 `per_user_limit` 设置，用户已达到领取上限。

### Q4: 页面样式显示异常？
**A**: 清除浏览器缓存，重新加载页面。

---

## 📝 后续优化

### 待开发功能

1. **结算页面集成**
   - 在购物车结算时选择优惠券
   - 实时计算优惠后金额
   - 显示可用优惠券列表

2. **管理后台页面**
   - 创建优惠券表单
   - 优惠券列表管理
   - 启用/禁用优惠券
   - 查看使用统计

3. **优化功能**
   - 优惠券搜索
   - 优惠券分享
   - 领取记录
   - 使用统计图表

---

## ✨ 总结

优惠券前端功能已完全实现，包括：

✅ **3个主要页面**
- 优惠券中心
- 我的优惠券  
- 导航入口

✅ **完整的功能**
- 查看可用优惠券
- 领取优惠券
- 查看我的优惠券
- 状态筛选

✅ **良好的用户体验**
- 美观的卡片设计
- 流畅的交互
- 清晰的反馈提示
- 响应式布局

🎉 **可以开始使用了！**

访问 http://localhost:3000 登录后即可体验完整的优惠券功能！

